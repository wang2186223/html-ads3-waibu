<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Analytics Test</title>
</head>
<body>
    <h1>统计测试页面</h1>
    <button onclick="testAnalytics()">测试发送数据</button>
    <div id="result"></div>
    
    <script>
    async function testAnalytics() {
        const resultDiv = document.getElementById('result');
        resultDiv.innerHTML = '正在发送测试数据...';
        
        const testData = {
            page: 'https://novel.7748.pw/test',
            userAgent: navigator.userAgent,
            referrer: 'test',
            userIP: '127.0.0.1'
        };
        
        console.log('发送的数据:', testData);
        
        try {
            const response = await fetch('https://script.google.com/macros/s/AKfycbzrH_le6Tt_ZJU1JuwoKteffLOqL6Uq2OqbFoj0926WTgwa1aYDAau8sp_nd3GdNjlUdg/exec', {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(testData)
            });
            
            resultDiv.innerHTML = '✅ 数据已发送（no-cors模式，无法查看响应）<br>请检查Google表格是否收到数据。<br><br>发送的数据：<pre>' + JSON.stringify(testData, null, 2) + '</pre>';
            console.log('数据发送成功');
        } catch (error) {
            resultDiv.innerHTML = '❌ 发送失败: ' + error.message;
            console.error('发送错误:', error);
        }
    }
    </script>
</body>
</html>
